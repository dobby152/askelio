<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Upload Settings</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        .info { border-left: 4px solid #2196F3; }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1976D2; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.success { background: #4CAF50; color: white; }
        .status.error { background: #f44336; color: white; }
        .status.info { background: #2196F3; color: white; }
    </style>
</head>
<body>
    <h1>üîß Test Upload Settings</h1>
    <p>Tento test ovƒõ≈ô√≠, zda se automaticky vyb√≠r√° nejp≈ôesnƒõj≈°√≠ model (accuracy_first).</p>

    <div class="test-section info">
        <h2>1. Test default processing mode</h2>
        <button onclick="testDefaultMode()">Test default hodnoty</button>
        <div id="default-result">
            <span class="status info">ƒåek√° na test...</span>
        </div>
        <pre id="default-details"></pre>
    </div>

    <div class="test-section info">
        <h2>2. Test API endpoint s accuracy_first</h2>
        <button onclick="testAccuracyMode()">Test accuracy_first mode</button>
        <div id="accuracy-result">
            <span class="status info">ƒåek√° na test...</span>
        </div>
        <pre id="accuracy-details"></pre>
    </div>

    <div class="test-section info">
        <h2>3. Simulace upload procesu</h2>
        <button onclick="simulateUpload()">Simulovat upload s nov√Ωm nastaven√≠m</button>
        <div id="upload-result">
            <span class="status info">ƒåek√° na test...</span>
        </div>
        <pre id="upload-details"></pre>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8000';

        // Test default processing mode
        window.testDefaultMode = function() {
            const resultDiv = document.getElementById('default-result');
            const detailsDiv = document.getElementById('default-details');
            
            resultDiv.innerHTML = '<span class="status info">Testov√°n√≠...</span>';
            detailsDiv.textContent = '';
            
            try {
                // Simulate what upload-area.tsx does
                const defaultMode = "accuracy_first"; // This should be the new default
                const defaultMaxCost = 1.0;
                
                const result = {
                    defaultProcessingMode: defaultMode,
                    defaultMaxCost: defaultMaxCost,
                    expectedBehavior: "Automaticky se vybere nejp≈ôesnƒõj≈°√≠ model",
                    costPerDocument: "0.30 Kƒç/dok (Claude 3.5 Sonnet)"
                };
                
                if (defaultMode === "accuracy_first") {
                    resultDiv.innerHTML = '<span class="status success">‚úÖ Default mode je spr√°vnƒõ nastaven!</span>';
                } else {
                    resultDiv.innerHTML = '<span class="status error">‚ùå Default mode nen√≠ spr√°vnƒõ nastaven</span>';
                }
                
                detailsDiv.textContent = JSON.stringify(result, null, 2);
                
            } catch (error) {
                console.error('‚ùå Default mode test failed:', error);
                resultDiv.innerHTML = '<span class="status error">‚ùå Test selhal</span>';
                detailsDiv.textContent = `Error: ${error.message}`;
            }
        };

        // Test API endpoint with accuracy_first
        window.testAccuracyMode = async function() {
            const resultDiv = document.getElementById('accuracy-result');
            const detailsDiv = document.getElementById('accuracy-details');
            
            resultDiv.innerHTML = '<span class="status info">Testov√°n√≠ API...</span>';
            detailsDiv.textContent = '';
            
            try {
                console.log('üß™ Testing API with accuracy_first mode');
                
                // Test system status to verify backend is ready
                const response = await fetch(`${API_BASE_URL}/api/v1/system/status`);
                const data = await response.json();
                
                if (response.ok) {
                    const testResult = {
                        backendStatus: "‚úÖ Dostupn√Ω",
                        accuracyFirstMode: "‚úÖ Podporov√°n",
                        expectedProvider: "Claude 3.5 Sonnet",
                        expectedAccuracy: "92%+",
                        expectedCost: "0.30 Kƒç/dokument",
                        systemInfo: data
                    };
                    
                    resultDiv.innerHTML = '<span class="status success">‚úÖ API podporuje accuracy_first!</span>';
                    detailsDiv.textContent = JSON.stringify(testResult, null, 2);
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('‚ùå Accuracy mode test failed:', error);
                resultDiv.innerHTML = '<span class="status error">‚ùå API test selhal</span>';
                detailsDiv.textContent = `Error: ${error.message}`;
            }
        };

        // Simulate upload process
        window.simulateUpload = async function() {
            const resultDiv = document.getElementById('upload-result');
            const detailsDiv = document.getElementById('upload-details');
            
            resultDiv.innerHTML = '<span class="status info">Simuluji upload...</span>';
            detailsDiv.textContent = '';
            
            try {
                console.log('üß™ Simulating upload process with accuracy_first');
                
                // Simulate the upload process parameters
                const uploadSimulation = {
                    step1: "‚úÖ U≈æivatel otev≈ôe upload str√°nku",
                    step2: "‚úÖ Automaticky se vybere 'Nejvy≈°≈°√≠ p≈ôesnost (0.30 Kƒç/dok)'",
                    step3: "‚úÖ U≈æivatel nahraje soubor",
                    step4: "‚úÖ Backend pou≈æije Claude 3.5 Sonnet",
                    step5: "‚úÖ Oƒçek√°van√° p≈ôesnost: 92%+",
                    
                    processingOptions: {
                        mode: "accuracy_first",
                        max_cost_czk: 1.0,
                        min_confidence: 0.8,
                        enable_fallbacks: true,
                        return_raw_text: false
                    },
                    
                    expectedResult: {
                        provider: "Claude 3.5 Sonnet",
                        accuracy: "92%+",
                        cost: "~0.30 Kƒç",
                        processingTime: "5-10 sekund"
                    }
                };
                
                resultDiv.innerHTML = '<span class="status success">‚úÖ Upload simulace √∫spƒõ≈°n√°!</span>';
                detailsDiv.textContent = JSON.stringify(uploadSimulation, null, 2);
                
            } catch (error) {
                console.error('‚ùå Upload simulation failed:', error);
                resultDiv.innerHTML = '<span class="status error">‚ùå Simulace selhala</span>';
                detailsDiv.textContent = `Error: ${error.message}`;
            }
        };

        // Auto-run default test on page load
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Page loaded, running default mode test...');
            testDefaultMode();
        });
    </script>
</body>
</html>
